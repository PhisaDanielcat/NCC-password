`timescale 1ns / 1ps



module top(
    input clk_sys,
    input reset_sys_n,
//    input ghash_str,
//    input ghash_run,
    input [15:0] ghash_data_len,
    input [127:0] ghash_din,
    input [127:0] ghash_key,
    input [127:0] ghash_ivin,
    output ghash_done,
    output ghash_busy,
    output [127:0] ghash_result
    );
    
    reg [15:0]ghash_data_len_rg;
    reg [127:0]ghash_din_rg;
    reg [127:0]ghash_key_rg;
    reg [127:0]ghash_ivin_rg;
    reg [127:0]A;
    reg [127:0]B;
   always@(posedge clk_sys or negedge reset_sys_n)
    if(!reset_sys_n)
        begin
            ghash_data_len_rg <= 0;
            ghash_din_rg <= 0;
            ghash_key_rg <= 0;
            ghash_ivin_rg <= 0;
            A<=0;
            B<=0;
        end
    else
        begin
            ghash_data_len_rg <= ghash_data_len;
            ghash_din_rg <= ghash_din;
            ghash_key_rg <= ghash_key;
            ghash_ivin_rg <= ghash_ivin;
        end    
    

    always@(posedge clk_sys or negedge reset_sys_n)
        if(!reset_sys_n)
        begin
            A <= 0;
            B <= 0;
        end
    else begin
            A <= ghash_din_rg^ghash_ivin_rg;
            B <= ghash_key_rg;
        end
        
    reg [127:0]Z[128:0];
    reg [127:0]V[128:0];
    integer i,j;
    wire[127:0]R;
    assign R={8'hE1,120'h0};
//    always@(*)
//        if(!reset_sys_n)begin
//            Z[0]=0;
//            V[0]=ghash_key_rg;
//            for(i=0;i<=128;i=i+1)begin
//                Z[i]=0;
//                V[i]=0;
//                end
//        end
//        else begin
//            for(j=1;j<=128;j=j+1)begin
//                if(A[j]==0)begin
//                    Z[j] = Z[j-1];
//                    V[j] = (V[j-1]>>1);end
//                else if(A[j]==1)
//                    Z[j] = Z[j-1]^V[j-1];
//                    V[j] = (V[j-1]>>1)^R;
//            end
//        end

    always@(*)
        if(!reset_sys_n)begin
            Z[0]=0;
            for(i=0;i<=128;i=i+1)begin
                Z[i]=0;
                end
        end
        else begin
           if(A[127]==0)
                    Z[1]=Z[0];
                else if(A[127]==1)
                    Z[1]=Z[0]^V[0];
           if(A[126]==0)
                    Z[2]=Z[1];
                else if(A[126]==1)
                    Z[2]=Z[1]^V[1];
           if(A[125]==0)
                    Z[3]=Z[2];
                else if(A[125]==1)
                    Z[3]=Z[2]^V[2];
           if(A[124]==0)
                    Z[4]=Z[3];
                else if(A[124]==1)
                    Z[4]=Z[3]^V[3];
           if(A[123]==0)
                    Z[5]=Z[4];
                else if(A[123]==1)
                    Z[5]=Z[4]^V[4];
           if(A[122]==0)
                    Z[6]=Z[5];
                else if(A[122]==1)
                    Z[6]=Z[5]^V[5];
           if(A[121]==0)
                    Z[7]=Z[6];
                else if(A[121]==1)
                    Z[7]=Z[6]^V[6];
           if(A[120]==0)
                    Z[8]=Z[7];
                else if(A[120]==1)
                    Z[8]=Z[7]^V[7];
           if(A[119]==0)
                    Z[9]=Z[8];
                else if(A[119]==1)
                    Z[9]=Z[8]^V[8];
           if(A[118]==0)
                    Z[10]=Z[9];
                else if(A[118]==1)
                    Z[10]=Z[9]^V[9];
           if(A[117]==0)
                    Z[11]=Z[10];
                else if(A[117]==1)
                    Z[11]=Z[10]^V[10];
           if(A[116]==0)
                    Z[12]=Z[11];
                else if(A[116]==1)
                    Z[12]=Z[11]^V[11];
           if(A[115]==0)
                    Z[13]=Z[12];
                else if(A[115]==1)
                    Z[13]=Z[12]^V[12];
           if(A[114]==0)
                    Z[14]=Z[13];
                else if(A[114]==1)
                    Z[14]=Z[13]^V[13];
           if(A[113]==0)
                    Z[15]=Z[14];
                else if(A[113]==1)
                    Z[15]=Z[14]^V[14];
           if(A[112]==0)
                    Z[16]=Z[15];
                else if(A[112]==1)
                    Z[16]=Z[15]^V[15];
           if(A[111]==0)
                    Z[17]=Z[16];
                else if(A[111]==1)
                    Z[17]=Z[16]^V[16];
           if(A[110]==0)
                    Z[18]=Z[17];
                else if(A[110]==1)
                    Z[18]=Z[17]^V[17];
           if(A[109]==0)
                    Z[19]=Z[18];
                else if(A[109]==1)
                    Z[19]=Z[18]^V[18];
           if(A[108]==0)
                    Z[20]=Z[19];
                else if(A[108]==1)
                    Z[20]=Z[19]^V[19];
           if(A[107]==0)
                    Z[21]=Z[20];
                else if(A[107]==1)
                    Z[21]=Z[20]^V[20];
           if(A[106]==0)
                    Z[22]=Z[21];
                else if(A[106]==1)
                    Z[22]=Z[21]^V[21];
           if(A[105]==0)
                    Z[23]=Z[22];
                else if(A[105]==1)
                    Z[23]=Z[22]^V[22];
           if(A[104]==0)
                    Z[24]=Z[23];
                else if(A[104]==1)
                    Z[24]=Z[23]^V[23];
           if(A[103]==0)
                    Z[25]=Z[24];
                else if(A[103]==1)
                    Z[25]=Z[24]^V[24];
           if(A[102]==0)
                    Z[26]=Z[25];
                else if(A[102]==1)
                    Z[26]=Z[25]^V[25];
           if(A[101]==0)
                    Z[27]=Z[26];
                else if(A[101]==1)
                    Z[27]=Z[26]^V[26];
           if(A[100]==0)
                    Z[28]=Z[27];
                else if(A[100]==1)
                    Z[28]=Z[27]^V[27];
           if(A[99]==0)
                    Z[29]=Z[28];
                else if(A[99]==1)
                    Z[29]=Z[28]^V[28];
           if(A[98]==0)
                    Z[30]=Z[29];
                else if(A[98]==1)
                    Z[30]=Z[29]^V[29];
           if(A[97]==0)
                    Z[31]=Z[30];
                else if(A[97]==1)
                    Z[31]=Z[30]^V[30];
           if(A[96]==0)
                    Z[32]=Z[31];
                else if(A[96]==1)
                    Z[32]=Z[31]^V[31];
           if(A[95]==0)
                    Z[33]=Z[32];
                else if(A[95]==1)
                    Z[33]=Z[32]^V[32];
           if(A[94]==0)
                    Z[34]=Z[33];
                else if(A[94]==1)
                    Z[34]=Z[33]^V[33];
           if(A[93]==0)
                    Z[35]=Z[34];
                else if(A[93]==1)
                    Z[35]=Z[34]^V[34];
           if(A[92]==0)
                    Z[36]=Z[35];
                else if(A[92]==1)
                    Z[36]=Z[35]^V[35];
           if(A[91]==0)
                    Z[37]=Z[36];
                else if(A[91]==1)
                    Z[37]=Z[36]^V[36];
           if(A[90]==0)
                    Z[38]=Z[37];
                else if(A[90]==1)
                    Z[38]=Z[37]^V[37];
           if(A[89]==0)
                    Z[39]=Z[38];
                else if(A[89]==1)
                    Z[39]=Z[38]^V[38];
           if(A[88]==0)
                    Z[40]=Z[39];
                else if(A[88]==1)
                    Z[40]=Z[39]^V[39];
           if(A[87]==0)
                    Z[41]=Z[40];
                else if(A[87]==1)
                    Z[41]=Z[40]^V[40];
           if(A[86]==0)
                    Z[42]=Z[41];
                else if(A[86]==1)
                    Z[42]=Z[41]^V[41];
           if(A[85]==0)
                    Z[43]=Z[42];
                else if(A[85]==1)
                    Z[43]=Z[42]^V[42];
           if(A[84]==0)
                    Z[44]=Z[43];
                else if(A[84]==1)
                    Z[44]=Z[43]^V[43];
           if(A[83]==0)
                    Z[45]=Z[44];
                else if(A[83]==1)
                    Z[45]=Z[44]^V[44];
           if(A[82]==0)
                    Z[46]=Z[45];
                else if(A[82]==1)
                    Z[46]=Z[45]^V[45];
           if(A[81]==0)
                    Z[47]=Z[46];
                else if(A[81]==1)
                    Z[47]=Z[46]^V[46];
           if(A[80]==0)
                    Z[48]=Z[47];
                else if(A[80]==1)
                    Z[48]=Z[47]^V[47];
           if(A[79]==0)
                    Z[49]=Z[48];
                else if(A[79]==1)
                    Z[49]=Z[48]^V[48];
           if(A[78]==0)
                    Z[50]=Z[49];
                else if(A[78]==1)
                    Z[50]=Z[49]^V[49];
           if(A[77]==0)
                    Z[51]=Z[50];
                else if(A[77]==1)
                    Z[51]=Z[50]^V[50];
           if(A[76]==0)
                    Z[52]=Z[51];
                else if(A[76]==1)
                    Z[52]=Z[51]^V[51];
           if(A[75]==0)
                    Z[53]=Z[52];
                else if(A[75]==1)
                    Z[53]=Z[52]^V[52];
           if(A[74]==0)
                    Z[54]=Z[53];
                else if(A[74]==1)
                    Z[54]=Z[53]^V[53];
           if(A[73]==0)
                    Z[55]=Z[54];
                else if(A[73]==1)
                    Z[55]=Z[54]^V[54];
           if(A[72]==0)
                    Z[56]=Z[55];
                else if(A[72]==1)
                    Z[56]=Z[55]^V[55];
           if(A[71]==0)
                    Z[57]=Z[56];
                else if(A[71]==1)
                    Z[57]=Z[56]^V[56];
           if(A[70]==0)
                    Z[58]=Z[57];
                else if(A[70]==1)
                    Z[58]=Z[57]^V[57];
           if(A[69]==0)
                    Z[59]=Z[58];
                else if(A[69]==1)
                    Z[59]=Z[58]^V[58];
           if(A[68]==0)
                    Z[60]=Z[59];
                else if(A[68]==1)
                    Z[60]=Z[59]^V[59];
           if(A[67]==0)
                    Z[61]=Z[60];
                else if(A[67]==1)
                    Z[61]=Z[60]^V[60];
           if(A[66]==0)
                    Z[62]=Z[61];
                else if(A[66]==1)
                    Z[62]=Z[61]^V[61];
           if(A[65]==0)
                    Z[63]=Z[62];
                else if(A[65]==1)
                    Z[63]=Z[62]^V[62];
           if(A[64]==0)
                    Z[64]=Z[63];
                else if(A[64]==1)
                    Z[64]=Z[63]^V[63];
           if(A[63]==0)
                    Z[65]=Z[64];
                else if(A[63]==1)
                    Z[65]=Z[64]^V[64];
           if(A[62]==0)
                    Z[66]=Z[65];
                else if(A[62]==1)
                    Z[66]=Z[65]^V[65];
           if(A[61]==0)
                    Z[67]=Z[66];
                else if(A[61]==1)
                    Z[67]=Z[66]^V[66];
           if(A[60]==0)
                    Z[68]=Z[67];
                else if(A[60]==1)
                    Z[68]=Z[67]^V[67];
           if(A[59]==0)
                    Z[69]=Z[68];
                else if(A[59]==1)
                    Z[69]=Z[68]^V[68];
           if(A[58]==0)
                    Z[70]=Z[69];
                else if(A[58]==1)
                    Z[70]=Z[69]^V[69];
           if(A[57]==0)
                    Z[71]=Z[70];
                else if(A[57]==1)
                    Z[71]=Z[70]^V[70];
           if(A[56]==0)
                    Z[72]=Z[71];
                else if(A[56]==1)
                    Z[72]=Z[71]^V[71];
           if(A[55]==0)
                    Z[73]=Z[72];
                else if(A[55]==1)
                    Z[73]=Z[72]^V[72];
           if(A[54]==0)
                    Z[74]=Z[73];
                else if(A[54]==1)
                    Z[74]=Z[73]^V[73];
           if(A[53]==0)
                    Z[75]=Z[74];
                else if(A[53]==1)
                    Z[75]=Z[74]^V[74];
           if(A[52]==0)
                    Z[76]=Z[75];
                else if(A[52]==1)
                    Z[76]=Z[75]^V[75];
           if(A[51]==0)
                    Z[77]=Z[76];
                else if(A[51]==1)
                    Z[77]=Z[76]^V[76];
           if(A[50]==0)
                    Z[78]=Z[77];
                else if(A[50]==1)
                    Z[78]=Z[77]^V[77];
           if(A[49]==0)
                    Z[79]=Z[78];
                else if(A[49]==1)
                    Z[79]=Z[78]^V[78];
           if(A[48]==0)
                    Z[80]=Z[79];
                else if(A[48]==1)
                    Z[80]=Z[79]^V[79];
           if(A[47]==0)
                    Z[81]=Z[80];
                else if(A[47]==1)
                    Z[81]=Z[80]^V[80];
           if(A[46]==0)
                    Z[82]=Z[81];
                else if(A[46]==1)
                    Z[82]=Z[81]^V[81];
           if(A[45]==0)
                    Z[83]=Z[82];
                else if(A[45]==1)
                    Z[83]=Z[82]^V[82];
           if(A[44]==0)
                    Z[84]=Z[83];
                else if(A[44]==1)
                    Z[84]=Z[83]^V[83];
           if(A[43]==0)
                    Z[85]=Z[84];
                else if(A[43]==1)
                    Z[85]=Z[84]^V[84];
           if(A[42]==0)
                    Z[86]=Z[85];
                else if(A[42]==1)
                    Z[86]=Z[85]^V[85];
           if(A[41]==0)
                    Z[87]=Z[86];
                else if(A[41]==1)
                    Z[87]=Z[86]^V[86];
           if(A[40]==0)
                    Z[88]=Z[87];
                else if(A[40]==1)
                    Z[88]=Z[87]^V[87];
           if(A[39]==0)
                    Z[89]=Z[88];
                else if(A[39]==1)
                    Z[89]=Z[88]^V[88];
           if(A[38]==0)
                    Z[90]=Z[89];
                else if(A[38]==1)
                    Z[90]=Z[89]^V[89];
           if(A[37]==0)
                    Z[91]=Z[90];
                else if(A[37]==1)
                    Z[91]=Z[90]^V[90];
           if(A[36]==0)
                    Z[92]=Z[91];
                else if(A[36]==1)
                    Z[92]=Z[91]^V[91];
           if(A[35]==0)
                    Z[93]=Z[92];
                else if(A[35]==1)
                    Z[93]=Z[92]^V[92];
           if(A[34]==0)
                    Z[94]=Z[93];
                else if(A[34]==1)
                    Z[94]=Z[93]^V[93];
           if(A[33]==0)
                    Z[95]=Z[94];
                else if(A[33]==1)
                    Z[95]=Z[94]^V[94];
           if(A[32]==0)
                    Z[96]=Z[95];
                else if(A[32]==1)
                    Z[96]=Z[95]^V[95];
           if(A[31]==0)
                    Z[97]=Z[96];
                else if(A[31]==1)
                    Z[97]=Z[96]^V[96];
           if(A[30]==0)
                    Z[98]=Z[97];
                else if(A[30]==1)
                    Z[98]=Z[97]^V[97];
           if(A[29]==0)
                    Z[99]=Z[98];
                else if(A[29]==1)
                    Z[99]=Z[98]^V[98];
           if(A[28]==0)
                    Z[100]=Z[99];
                else if(A[28]==1)
                    Z[100]=Z[99]^V[99];
           if(A[27]==0)
                    Z[101]=Z[100];
                else if(A[27]==1)
                    Z[101]=Z[100]^V[100];
           if(A[26]==0)
                    Z[102]=Z[101];
                else if(A[26]==1)
                    Z[102]=Z[101]^V[101];
           if(A[25]==0)
                    Z[103]=Z[102];
                else if(A[25]==1)
                    Z[103]=Z[102]^V[102];
           if(A[24]==0)
                    Z[104]=Z[103];
                else if(A[24]==1)
                    Z[104]=Z[103]^V[103];
           if(A[23]==0)
                    Z[105]=Z[104];
                else if(A[23]==1)
                    Z[105]=Z[104]^V[104];
           if(A[22]==0)
                    Z[106]=Z[105];
                else if(A[22]==1)
                    Z[106]=Z[105]^V[105];
           if(A[21]==0)
                    Z[107]=Z[106];
                else if(A[21]==1)
                    Z[107]=Z[106]^V[106];
           if(A[20]==0)
                    Z[108]=Z[107];
                else if(A[20]==1)
                    Z[108]=Z[107]^V[107];
           if(A[19]==0)
                    Z[109]=Z[108];
                else if(A[19]==1)
                    Z[109]=Z[108]^V[108];
           if(A[18]==0)
                    Z[110]=Z[109];
                else if(A[18]==1)
                    Z[110]=Z[109]^V[109];
           if(A[17]==0)
                    Z[111]=Z[110];
                else if(A[17]==1)
                    Z[111]=Z[110]^V[110];
           if(A[16]==0)
                    Z[112]=Z[111];
                else if(A[16]==1)
                    Z[112]=Z[111]^V[111];
           if(A[15]==0)
                    Z[113]=Z[112];
                else if(A[15]==1)
                    Z[113]=Z[112]^V[112];
           if(A[14]==0)
                    Z[114]=Z[113];
                else if(A[14]==1)
                    Z[114]=Z[113]^V[113];
           if(A[13]==0)
                    Z[115]=Z[114];
                else if(A[13]==1)
                    Z[115]=Z[114]^V[114];
           if(A[12]==0)
                    Z[116]=Z[115];
                else if(A[12]==1)
                    Z[116]=Z[115]^V[115];
           if(A[11]==0)
                    Z[117]=Z[116];
                else if(A[11]==1)
                    Z[117]=Z[116]^V[116];
           if(A[10]==0)
                    Z[118]=Z[117];
                else if(A[10]==1)
                    Z[118]=Z[117]^V[117];
           if(A[9]==0)
                    Z[119]=Z[118];
                else if(A[9]==1)
                    Z[119]=Z[118]^V[118];
           if(A[8]==0)
                    Z[120]=Z[119];
                else if(A[8]==1)
                    Z[120]=Z[119]^V[119];
           if(A[7]==0)
                    Z[121]=Z[120];
                else if(A[7]==1)
                    Z[121]=Z[120]^V[120];
           if(A[6]==0)
                    Z[122]=Z[121];
                else if(A[6]==1)
                    Z[122]=Z[121]^V[121];
           if(A[5]==0)
                    Z[123]=Z[122];
                else if(A[5]==1)
                    Z[123]=Z[122]^V[122];
           if(A[4]==0)
                    Z[124]=Z[123];
                else if(A[4]==1)
                    Z[124]=Z[123]^V[123];
           if(A[3]==0)
                    Z[125]=Z[124];
                else if(A[3]==1)
                    Z[125]=Z[124]^V[124];
           if(A[2]==0)
                    Z[126]=Z[125];
                else if(A[2]==1)
                    Z[126]=Z[125]^V[125];
           if(A[1]==0)
                    Z[127]=Z[126];
                else if(A[1]==1)
                    Z[127]=Z[126]^V[126];
           if(A[0]==0)
                    Z[128]=Z[127];
                else if(A[0]==1)
                    Z[128]=Z[127]^V[127];
            end
            
        always@(*)
        if(!reset_sys_n)begin
            V[0]=0;
            for(j=0;j<=128;j=j+1)begin
                V[j]=0;
                end
        end
        else begin
        V[0]=ghash_key_rg;
        
           if(V[0][0]==0)
                    V[1]=V[0]>>1;
                else if(V[0][0]==1)
                    V[1]=(V[0]>>1)^R;
           if(V[1][0]==0)
                    V[2]=V[1]>>1;
                else if(V[1][0]==1)
                    V[2]=(V[1]>>1)^R;
           if(V[2][0]==0)
                    V[3]=V[2]>>1;
                else if(V[2][0]==1)
                    V[3]=(V[2]>>1)^R;
           if(V[3][0]==0)
                    V[4]=V[3]>>1;
                else if(V[3][0]==1)
                    V[4]=(V[3]>>1)^R;
           if(V[4][0]==0)
                    V[5]=V[4]>>1;
                else if(V[4][0]==1)
                    V[5]=(V[4]>>1)^R;
           if(V[5][0]==0)
                    V[6]=V[5]>>1;
                else if(V[5][0]==1)
                    V[6]=(V[5]>>1)^R;
           if(V[6][0]==0)
                    V[7]=V[6]>>1;
                else if(V[6][0]==1)
                    V[7]=(V[6]>>1)^R;
           if(V[7][0]==0)
                    V[8]=V[7]>>1;
                else if(V[7][0]==1)
                    V[8]=(V[7]>>1)^R;
           if(V[8][0]==0)
                    V[9]=V[8]>>1;
                else if(V[8][0]==1)
                    V[9]=(V[8]>>1)^R;
           if(V[9][0]==0)
                    V[10]=V[9]>>1;
                else if(V[9][0]==1)
                    V[10]=(V[9]>>1)^R;
           if(V[10][0]==0)
                    V[11]=V[10]>>1;
                else if(V[10][0]==1)
                    V[11]=(V[10]>>1)^R;
           if(V[11][0]==0)
                    V[12]=V[11]>>1;
                else if(V[11][0]==1)
                    V[12]=(V[11]>>1)^R;
           if(V[12][0]==0)
                    V[13]=V[12]>>1;
                else if(V[12][0]==1)
                    V[13]=(V[12]>>1)^R;
           if(V[13][0]==0)
                    V[14]=V[13]>>1;
                else if(V[13][0]==1)
                    V[14]=(V[13]>>1)^R;
           if(V[14][0]==0)
                    V[15]=V[14]>>1;
                else if(V[14][0]==1)
                    V[15]=(V[14]>>1)^R;
           if(V[15][0]==0)
                    V[16]=V[15]>>1;
                else if(V[15][0]==1)
                    V[16]=(V[15]>>1)^R;
           if(V[16][0]==0)
                    V[17]=V[16]>>1;
                else if(V[16][0]==1)
                    V[17]=(V[16]>>1)^R;
           if(V[17][0]==0)
                    V[18]=V[17]>>1;
                else if(V[17][0]==1)
                    V[18]=(V[17]>>1)^R;
           if(V[18][0]==0)
                    V[19]=V[18]>>1;
                else if(V[18][0]==1)
                    V[19]=(V[18]>>1)^R;
           if(V[19][0]==0)
                    V[20]=V[19]>>1;
                else if(V[19][0]==1)
                    V[20]=(V[19]>>1)^R;
           if(V[20][0]==0)
                    V[21]=V[20]>>1;
                else if(V[20][0]==1)
                    V[21]=(V[20]>>1)^R;
           if(V[21][0]==0)
                    V[22]=V[21]>>1;
                else if(V[21][0]==1)
                    V[22]=(V[21]>>1)^R;
           if(V[22][0]==0)
                    V[23]=V[22]>>1;
                else if(V[22][0]==1)
                    V[23]=(V[22]>>1)^R;
           if(V[23][0]==0)
                    V[24]=V[23]>>1;
                else if(V[23][0]==1)
                    V[24]=(V[23]>>1)^R;
           if(V[24][0]==0)
                    V[25]=V[24]>>1;
                else if(V[24][0]==1)
                    V[25]=(V[24]>>1)^R;
           if(V[25][0]==0)
                    V[26]=V[25]>>1;
                else if(V[25][0]==1)
                    V[26]=(V[25]>>1)^R;
           if(V[26][0]==0)
                    V[27]=V[26]>>1;
                else if(V[26][0]==1)
                    V[27]=(V[26]>>1)^R;
           if(V[27][0]==0)
                    V[28]=V[27]>>1;
                else if(V[27][0]==1)
                    V[28]=(V[27]>>1)^R;
           if(V[28][0]==0)
                    V[29]=V[28]>>1;
                else if(V[28][0]==1)
                    V[29]=(V[28]>>1)^R;
           if(V[29][0]==0)
                    V[30]=V[29]>>1;
                else if(V[29][0]==1)
                    V[30]=(V[29]>>1)^R;
           if(V[30][0]==0)
                    V[31]=V[30]>>1;
                else if(V[30][0]==1)
                    V[31]=(V[30]>>1)^R;
           if(V[31][0]==0)
                    V[32]=V[31]>>1;
                else if(V[31][0]==1)
                    V[32]=(V[31]>>1)^R;
           if(V[32][0]==0)
                    V[33]=V[32]>>1;
                else if(V[32][0]==1)
                    V[33]=(V[32]>>1)^R;
           if(V[33][0]==0)
                    V[34]=V[33]>>1;
                else if(V[33][0]==1)
                    V[34]=(V[33]>>1)^R;
           if(V[34][0]==0)
                    V[35]=V[34]>>1;
                else if(V[34][0]==1)
                    V[35]=(V[34]>>1)^R;
           if(V[35][0]==0)
                    V[36]=V[35]>>1;
                else if(V[35][0]==1)
                    V[36]=(V[35]>>1)^R;
           if(V[36][0]==0)
                    V[37]=V[36]>>1;
                else if(V[36][0]==1)
                    V[37]=(V[36]>>1)^R;
           if(V[37][0]==0)
                    V[38]=V[37]>>1;
                else if(V[37][0]==1)
                    V[38]=(V[37]>>1)^R;
           if(V[38][0]==0)
                    V[39]=V[38]>>1;
                else if(V[38][0]==1)
                    V[39]=(V[38]>>1)^R;
           if(V[39][0]==0)
                    V[40]=V[39]>>1;
                else if(V[39][0]==1)
                    V[40]=(V[39]>>1)^R;
           if(V[40][0]==0)
                    V[41]=V[40]>>1;
                else if(V[40][0]==1)
                    V[41]=(V[40]>>1)^R;
           if(V[41][0]==0)
                    V[42]=V[41]>>1;
                else if(V[41][0]==1)
                    V[42]=(V[41]>>1)^R;
           if(V[42][0]==0)
                    V[43]=V[42]>>1;
                else if(V[42][0]==1)
                    V[43]=(V[42]>>1)^R;
           if(V[43][0]==0)
                    V[44]=V[43]>>1;
                else if(V[43][0]==1)
                    V[44]=(V[43]>>1)^R;
           if(V[44][0]==0)
                    V[45]=V[44]>>1;
                else if(V[44][0]==1)
                    V[45]=(V[44]>>1)^R;
           if(V[45][0]==0)
                    V[46]=V[45]>>1;
                else if(V[45][0]==1)
                    V[46]=(V[45]>>1)^R;
           if(V[46][0]==0)
                    V[47]=V[46]>>1;
                else if(V[46][0]==1)
                    V[47]=(V[46]>>1)^R;
           if(V[47][0]==0)
                    V[48]=V[47]>>1;
                else if(V[47][0]==1)
                    V[48]=(V[47]>>1)^R;
           if(V[48][0]==0)
                    V[49]=V[48]>>1;
                else if(V[48][0]==1)
                    V[49]=(V[48]>>1)^R;
           if(V[49][0]==0)
                    V[50]=V[49]>>1;
                else if(V[49][0]==1)
                    V[50]=(V[49]>>1)^R;
           if(V[50][0]==0)
                    V[51]=V[50]>>1;
                else if(V[50][0]==1)
                    V[51]=(V[50]>>1)^R;
           if(V[51][0]==0)
                    V[52]=V[51]>>1;
                else if(V[51][0]==1)
                    V[52]=(V[51]>>1)^R;
           if(V[52][0]==0)
                    V[53]=V[52]>>1;
                else if(V[52][0]==1)
                    V[53]=(V[52]>>1)^R;
           if(V[53][0]==0)
                    V[54]=V[53]>>1;
                else if(V[53][0]==1)
                    V[54]=(V[53]>>1)^R;
           if(V[54][0]==0)
                    V[55]=V[54]>>1;
                else if(V[54][0]==1)
                    V[55]=(V[54]>>1)^R;
           if(V[55][0]==0)
                    V[56]=V[55]>>1;
                else if(V[55][0]==1)
                    V[56]=(V[55]>>1)^R;
           if(V[56][0]==0)
                    V[57]=V[56]>>1;
                else if(V[56][0]==1)
                    V[57]=(V[56]>>1)^R;
           if(V[57][0]==0)
                    V[58]=V[57]>>1;
                else if(V[57][0]==1)
                    V[58]=(V[57]>>1)^R;
           if(V[58][0]==0)
                    V[59]=V[58]>>1;
                else if(V[58][0]==1)
                    V[59]=(V[58]>>1)^R;
           if(V[59][0]==0)
                    V[60]=V[59]>>1;
                else if(V[59][0]==1)
                    V[60]=(V[59]>>1)^R;
           if(V[60][0]==0)
                    V[61]=V[60]>>1;
                else if(V[60][0]==1)
                    V[61]=(V[60]>>1)^R;
           if(V[61][0]==0)
                    V[62]=V[61]>>1;
                else if(V[61][0]==1)
                    V[62]=(V[61]>>1)^R;
           if(V[62][0]==0)
                    V[63]=V[62]>>1;
                else if(V[62][0]==1)
                    V[63]=(V[62]>>1)^R;
           if(V[63][0]==0)
                    V[64]=V[63]>>1;
                else if(V[63][0]==1)
                    V[64]=(V[63]>>1)^R;
           if(V[64][0]==0)
                    V[65]=V[64]>>1;
                else if(V[64][0]==1)
                    V[65]=(V[64]>>1)^R;
           if(V[65][0]==0)
                    V[66]=V[65]>>1;
                else if(V[65][0]==1)
                    V[66]=(V[65]>>1)^R;
           if(V[66][0]==0)
                    V[67]=V[66]>>1;
                else if(V[66][0]==1)
                    V[67]=(V[66]>>1)^R;
           if(V[67][0]==0)
                    V[68]=V[67]>>1;
                else if(V[67][0]==1)
                    V[68]=(V[67]>>1)^R;
           if(V[68][0]==0)
                    V[69]=V[68]>>1;
                else if(V[68][0]==1)
                    V[69]=(V[68]>>1)^R;
           if(V[69][0]==0)
                    V[70]=V[69]>>1;
                else if(V[69][0]==1)
                    V[70]=(V[69]>>1)^R;
           if(V[70][0]==0)
                    V[71]=V[70]>>1;
                else if(V[70][0]==1)
                    V[71]=(V[70]>>1)^R;
           if(V[71][0]==0)
                    V[72]=V[71]>>1;
                else if(V[71][0]==1)
                    V[72]=(V[71]>>1)^R;
           if(V[72][0]==0)
                    V[73]=V[72]>>1;
                else if(V[72][0]==1)
                    V[73]=(V[72]>>1)^R;
           if(V[73][0]==0)
                    V[74]=V[73]>>1;
                else if(V[73][0]==1)
                    V[74]=(V[73]>>1)^R;
           if(V[74][0]==0)
                    V[75]=V[74]>>1;
                else if(V[74][0]==1)
                    V[75]=(V[74]>>1)^R;
           if(V[75][0]==0)
                    V[76]=V[75]>>1;
                else if(V[75][0]==1)
                    V[76]=(V[75]>>1)^R;
           if(V[76][0]==0)
                    V[77]=V[76]>>1;
                else if(V[76][0]==1)
                    V[77]=(V[76]>>1)^R;
           if(V[77][0]==0)
                    V[78]=V[77]>>1;
                else if(V[77][0]==1)
                    V[78]=(V[77]>>1)^R;
           if(V[78][0]==0)
                    V[79]=V[78]>>1;
                else if(V[78][0]==1)
                    V[79]=(V[78]>>1)^R;
           if(V[79][0]==0)
                    V[80]=V[79]>>1;
                else if(V[79][0]==1)
                    V[80]=(V[79]>>1)^R;
           if(V[80][0]==0)
                    V[81]=V[80]>>1;
                else if(V[80][0]==1)
                    V[81]=(V[80]>>1)^R;
           if(V[81][0]==0)
                    V[82]=V[81]>>1;
                else if(V[81][0]==1)
                    V[82]=(V[81]>>1)^R;
           if(V[82][0]==0)
                    V[83]=V[82]>>1;
                else if(V[82][0]==1)
                    V[83]=(V[82]>>1)^R;
           if(V[83][0]==0)
                    V[84]=V[83]>>1;
                else if(V[83][0]==1)
                    V[84]=(V[83]>>1)^R;
           if(V[84][0]==0)
                    V[85]=V[84]>>1;
                else if(V[84][0]==1)
                    V[85]=(V[84]>>1)^R;
           if(V[85][0]==0)
                    V[86]=V[85]>>1;
                else if(V[85][0]==1)
                    V[86]=(V[85]>>1)^R;
           if(V[86][0]==0)
                    V[87]=V[86]>>1;
                else if(V[86][0]==1)
                    V[87]=(V[86]>>1)^R;
           if(V[87][0]==0)
                    V[88]=V[87]>>1;
                else if(V[87][0]==1)
                    V[88]=(V[87]>>1)^R;
           if(V[88][0]==0)
                    V[89]=V[88]>>1;
                else if(V[88][0]==1)
                    V[89]=(V[88]>>1)^R;
           if(V[89][0]==0)
                    V[90]=V[89]>>1;
                else if(V[89][0]==1)
                    V[90]=(V[89]>>1)^R;
           if(V[90][0]==0)
                    V[91]=V[90]>>1;
                else if(V[90][0]==1)
                    V[91]=(V[90]>>1)^R;
           if(V[91][0]==0)
                    V[92]=V[91]>>1;
                else if(V[91][0]==1)
                    V[92]=(V[91]>>1)^R;
           if(V[92][0]==0)
                    V[93]=V[92]>>1;
                else if(V[92][0]==1)
                    V[93]=(V[92]>>1)^R;
           if(V[93][0]==0)
                    V[94]=V[93]>>1;
                else if(V[93][0]==1)
                    V[94]=(V[93]>>1)^R;
           if(V[94][0]==0)
                    V[95]=V[94]>>1;
                else if(V[94][0]==1)
                    V[95]=(V[94]>>1)^R;
           if(V[95][0]==0)
                    V[96]=V[95]>>1;
                else if(V[95][0]==1)
                    V[96]=(V[95]>>1)^R;
           if(V[96][0]==0)
                    V[97]=V[96]>>1;
                else if(V[96][0]==1)
                    V[97]=(V[96]>>1)^R;
           if(V[97][0]==0)
                    V[98]=V[97]>>1;
                else if(V[97][0]==1)
                    V[98]=(V[97]>>1)^R;
           if(V[98][0]==0)
                    V[99]=V[98]>>1;
                else if(V[98][0]==1)
                    V[99]=(V[98]>>1)^R;
           if(V[99][0]==0)
                    V[100]=V[99]>>1;
                else if(V[99][0]==1)
                    V[100]=(V[99]>>1)^R;
           if(V[100][0]==0)
                    V[101]=V[100]>>1;
                else if(V[100][0]==1)
                    V[101]=(V[100]>>1)^R;
           if(V[101][0]==0)
                    V[102]=V[101]>>1;
                else if(V[101][0]==1)
                    V[102]=(V[101]>>1)^R;
           if(V[102][0]==0)
                    V[103]=V[102]>>1;
                else if(V[102][0]==1)
                    V[103]=(V[102]>>1)^R;
           if(V[103][0]==0)
                    V[104]=V[103]>>1;
                else if(V[103][0]==1)
                    V[104]=(V[103]>>1)^R;
           if(V[104][0]==0)
                    V[105]=V[104]>>1;
                else if(V[104][0]==1)
                    V[105]=(V[104]>>1)^R;
           if(V[105][0]==0)
                    V[106]=V[105]>>1;
                else if(V[105][0]==1)
                    V[106]=(V[105]>>1)^R;
           if(V[106][0]==0)
                    V[107]=V[106]>>1;
                else if(V[106][0]==1)
                    V[107]=(V[106]>>1)^R;
           if(V[107][0]==0)
                    V[108]=V[107]>>1;
                else if(V[107][0]==1)
                    V[108]=(V[107]>>1)^R;
           if(V[108][0]==0)
                    V[109]=V[108]>>1;
                else if(V[108][0]==1)
                    V[109]=(V[108]>>1)^R;
           if(V[109][0]==0)
                    V[110]=V[109]>>1;
                else if(V[109][0]==1)
                    V[110]=(V[109]>>1)^R;
           if(V[110][0]==0)
                    V[111]=V[110]>>1;
                else if(V[110][0]==1)
                    V[111]=(V[110]>>1)^R;
           if(V[111][0]==0)
                    V[112]=V[111]>>1;
                else if(V[111][0]==1)
                    V[112]=(V[111]>>1)^R;
           if(V[112][0]==0)
                    V[113]=V[112]>>1;
                else if(V[112][0]==1)
                    V[113]=(V[112]>>1)^R;
           if(V[113][0]==0)
                    V[114]=V[113]>>1;
                else if(V[113][0]==1)
                    V[114]=(V[113]>>1)^R;
           if(V[114][0]==0)
                    V[115]=V[114]>>1;
                else if(V[114][0]==1)
                    V[115]=(V[114]>>1)^R;
           if(V[115][0]==0)
                    V[116]=V[115]>>1;
                else if(V[115][0]==1)
                    V[116]=(V[115]>>1)^R;
           if(V[116][0]==0)
                    V[117]=V[116]>>1;
                else if(V[116][0]==1)
                    V[117]=(V[116]>>1)^R;
           if(V[117][0]==0)
                    V[118]=V[117]>>1;
                else if(V[117][0]==1)
                    V[118]=(V[117]>>1)^R;
           if(V[118][0]==0)
                    V[119]=V[118]>>1;
                else if(V[118][0]==1)
                    V[119]=(V[118]>>1)^R;
           if(V[119][0]==0)
                    V[120]=V[119]>>1;
                else if(V[119][0]==1)
                    V[120]=(V[119]>>1)^R;
           if(V[120][0]==0)
                    V[121]=V[120]>>1;
                else if(V[120][0]==1)
                    V[121]=(V[120]>>1)^R;
           if(V[121][0]==0)
                    V[122]=V[121]>>1;
                else if(V[121][0]==1)
                    V[122]=(V[121]>>1)^R;
           if(V[122][0]==0)
                    V[123]=V[122]>>1;
                else if(V[122][0]==1)
                    V[123]=(V[122]>>1)^R;
           if(V[123][0]==0)
                    V[124]=V[123]>>1;
                else if(V[123][0]==1)
                    V[124]=(V[123]>>1)^R;
           if(V[124][0]==0)
                    V[125]=V[124]>>1;
                else if(V[124][0]==1)
                    V[125]=(V[124]>>1)^R;
           if(V[125][0]==0)
                    V[126]=V[125]>>1;
                else if(V[125][0]==1)
                    V[126]=(V[125]>>1)^R;
           if(V[126][0]==0)
                    V[127]=V[126]>>1;
                else if(V[126][0]==1)
                    V[127]=(V[126]>>1)^R;
           if(V[127][0]==0)
                    V[128]=V[127]>>1;
                else if(V[127][0]==1)
                    V[128]=(V[127]>>1)^R;
            end

    assign ghash_result=Z[128];

    
endmodule
